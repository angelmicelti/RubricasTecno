<!DOCTYPE html>
<html lang="es">
<head>
	<link rel="manifest" href="./manifest.json" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <title>Rúbricas Tecnología 4º ESO</title>
    /* <script src="https://cdn.tailwindcss.com"></script> */
    <script src="https://unpkg.com/tailwindcss-cdn@3.4.10/tailwindcss.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        /* Estilo para la fuente Inter */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Estilo para el scrollbar (opcional pero mejora la estética) */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1; /* cool-gray-300 */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; /* cool-gray-400 */
        }
        ::-webkit-scrollbar-track {
            background: #f1f5f9; /* cool-gray-100 */
        }
        
        /* Estilos para el tooltip - CORREGIDOS */
        .tooltip-container {
            position: relative;
            display: inline-block;
        }
        
        .tooltip-content {
            visibility: hidden;
            width: 320px;
            background-color: #1f2937;
            color: white;
            text-align: left;
            border-radius: 6px;
            padding: 12px 16px;
            position: absolute;
            z-index: 100;
            top: 125%; /* Cambiado de bottom a top */
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            font-size: 0.875rem;
        }
        
        .tooltip-container:hover .tooltip-content {
            visibility: visible;
            opacity: 1;
        }
        
        .tooltip-content::after {
            content: "";
            position: absolute;
            bottom: 100%; /* Cambiado de top a bottom */
            left: 50%;
            margin-left: -8px;
            border-width: 8px;
            border-style: solid;
            border-color: transparent transparent #1f2937 transparent; /* Cambiado para que apunte hacia arriba */
        }
        
        .tooltip-trigger {
            border-bottom: 1px dashed #6b7280;
            cursor: help;
            padding-bottom: 2px;
        }
        
        .tooltip-trigger:hover {
            color: #3b82f6;
        }

        /* Estilos responsivos adicionales */
        @media (max-width: 768px) {
            .rubric-table {
                font-size: 0.75rem;
            }
            
            .rubric-cell {
                padding: 0.5rem 0.25rem;
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .sidebar {
                position: fixed;
                top: 0;
                left: -100%;
                width: 80%;
                height: 100vh;
                z-index: 40;
                transition: left 0.3s ease;
            }
            
            .sidebar.open {
                left: 0;
            }
            
            .overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background-color: rgba(0, 0, 0, 0.5);
                z-index: 30;
            }
            
            .overlay.open {
                display: block;
            }
        }
        
        @media (max-width: 640px) {
            .main-title {
                font-size: 1.5rem;
            }
            
            .btn-text {
                font-size: 0.875rem;
            }
        }
    </style>
</head>
<body class="bg-gray-100">

    <div id="main-screen" class="min-h-screen flex flex-col justify-center items-center p-4 sm:p-6">
        <div class="max-w-lg w-full bg-white rounded-xl shadow-lg p-6 md:p-8 lg:p-10">
            <div class="flex justify-center mb-4 md:mb-6">
                <div class="w-16 h-16 md:w-20 md:h-20 lg:w-24 lg:h-24 rounded-full bg-blue-100 flex items-center justify-center">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 md:h-10 md:w-10 lg:h-12 lg:w-12 text-blue-600" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z" clip-rule="evenodd" />
                    </svg>
                </div>
            </div>
            
            <div class="text-center mb-6 md:mb-8">
                <h1 class="main-title text-2xl md:text-3xl lg:text-4xl font-bold text-gray-800 mb-1 md:mb-2">CRITERIOS DE EVALUACIÓN <br> Y <br> RÚBRICAS</h1>
                <p class="text-base md:text-lg text-gray-600">TECNOLOGÍA 4º ESO</p>
            </div>
            
            <div class="space-y-3 md:space-y-4">
                <button id="btn-competencias" class="w-full py-3 md:py-4 px-4 md:px-6 rounded-lg bg-blue-600 text-white font-semibold text-base md:text-lg hover:bg-blue-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 shadow-sm flex items-center justify-center gap-2 md:gap-3">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 md:h-6 md:w-6" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03zM12.12 15.12A3 3 0 017 13s.879.5 2.5.5c0-1 .5-4 1.25-4.5.5 1 .786 1.293 1.371 1.879A2.99 2.99 0 0113 13a2.99 2.99 0 01-.879 2.121z" clip-rule="evenodd" />
                    </svg>
                    <span class="btn-text">Selección por competencias específicas</span>
                </button>
                
                <button id="btn-multiple" class="w-full py-3 md:py-4 px-4 md:px-6 rounded-lg bg-green-600 text-white font-semibold text-base md:text-lg hover:bg-green-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 shadow-sm flex items-center justify-center gap-2 md:gap-3">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 md:h-6 md:w-6" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                    </svg>
                    <span class="btn-text">Selección múltiple</span>
                </button>
            </div>
        </div>
    </div>

    <div id="competencias-screen" class="min-h-screen flex flex-col" style="display: none;">
        <div class="flex flex-col md:flex-row min-h-screen">
            <button id="mobile-menu-btn-competencias" class="mobile-menu-btn md:hidden fixed top-4 left-4 z-50 p-2 rounded-md bg-blue-600 text-white">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                </svg>
            </button>
            
            <div id="overlay-competencias" class="overlay"></div>
            
            <nav id="sidebar-competencias" class="sidebar w-full md:w-64 lg:w-72 bg-white shadow-md flex-shrink-0">
                <div class="p-4 md:p-6 border-b">
                    <div class="flex justify-between items-center">
                        <div>
                            <h1 class="text-lg md:text-xl lg:text-2xl font-bold text-gray-800">Tecnología 4º ESO</h1>
                            <p class="text-sm text-gray-500">Selección por Competencias</p>
                        </div>
                        <button id="close-sidebar-competencias" class="md:hidden p-1 rounded-md bg-gray-200">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
                            </svg>
                        </button>
                    </div>
                    <button id="back-from-competencias" class="mt-1 md:mt-2 text-sm text-blue-600 hover:text-blue-800 font-medium flex items-center gap-1">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" />
                        </svg>
                        Volver al inicio
                    </button>
                </div>
                <div class="p-3 md:p-4 overflow-y-auto md:h-[calc(100vh-105px)]">
                    <ul id="competencias-lista" class="space-y-1.5">
                        </ul>
                </div>
            </nav>

            <main class="flex-1 p-3 md:p-4 lg:p-6 xl:p-8 overflow-y-auto mt-14 md:mt-0">
                <div id="export-container-competencias" class="mb-4 md:mb-6" style="display: none;">
                    
                    <div class="mb-3">
                        <label for="export-format-competencias" class="block text-sm font-medium text-gray-700 mb-1">Formato de Puntuación:</label>
                        <select id="export-format-competencias" name="export-format-competencias" class="w-full md:w-auto block py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                            <option value="1">10, 8, 6, 4, 2 (5 niveles)</option>
                            <option value="2">10, 8, 6, 4, 2, 0 (6 niveles, con "No entregado")</option>
                            <option value="3">10, 8.5, 7.5 ... 1.5 (9 niveles)</option>
                            <option value="4">10, 8.5, 7.5 ... 1.5, 0 (10 niveles, con "No entregado")</option>
                        </select>
                    </div>
                    <button id="export-csv-button-competencias" class="w-full md:w-auto flex items-center justify-center gap-2 px-4 py-2 md:px-5 md:py-3 rounded-lg bg-green-600 text-white font-medium hover:bg-green-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 shadow-sm">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 md:h-5 md:w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z" clip-rule="evenodd" />
                        </svg>
                        Exportar a Google Classroom (CSV)
                    </button>
                    <div class="text-sm text-gray-600 mt-2">
                        <div class="tooltip-container">
                            <span class="tooltip-trigger">Archivo .csv para llevar a Google Classroom</span>
                            <div class="tooltip-content">
                                <p class="font-semibold mb-2 text-white">Siguientes pasos:</p>
                                <ol class="list-decimal pl-5 space-y-1 text-gray-200">
                                    <li>Exporta el .csv desde la aplicación</li>
                                    <li>Abre una Google Sheet en blanco</li>
                                    <li>Importa el archivo .csv a la Google Sheet</li>
                                    <li>Renombra la Google Sheet, por ejemplo, a "Rúbrica para importar"</li>
                                    <li>Importa la rúbrica desde Classroom</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="rubrics-container-competencias" class="space-y-6 md:space-y-8">
                    </div>

                <div id="welcome-message-competencias" class="text-center p-6 md:p-8 lg:p-10 bg-white rounded-xl shadow-lg">
                    <svg class="mx-auto h-10 w-10 md:h-12 md:w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    <h3 class="mt-2 text-base md:text-lg font-medium text-gray-800">Selecciona una Competencia</h3>
                    <p class="mt-1 text-xs md:text-sm text-gray-500">Haz clic en una competencia de la barra lateral para ver sus criterios de evaluación.</p>
                </div>
            </main>
        </div>
    </div>

    <div id="multiple-screen" class="min-h-screen flex flex-col" style="display: none;">
        <div class="flex flex-col md:flex-row min-h-screen">
            <button id="mobile-menu-btn-multiple" class="mobile-menu-btn md:hidden fixed top-4 left-4 z-50 p-2 rounded-md bg-blue-600 text-white">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                </svg>
            </button>
            
            <div id="overlay-multiple" class="overlay"></div>
            
            <nav id="sidebar-multiple" class="sidebar w-full md:w-64 lg:w-72 bg-white shadow-md flex-shrink-0">
                <div class="p-4 md:p-6 border-b">
                    <div class="flex justify-between items-center">
                        <div>
                            <h1 class="text-lg md:text-xl lg:text-2xl font-bold text-gray-800">Tecnología 4º ESO</h1>
                            <p class="text-sm text-gray-500">Criterios de Evaluación</p>
                        </div>
                        <button id="close-sidebar-multiple" class="md:hidden p-1 rounded-md bg-gray-200">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
                            </svg>
                        </button>
                    </div>
                    <button id="back-from-multiple" class="mt-1 md:mt-2 text-sm text-blue-600 hover:text-blue-800 font-medium flex items-center gap-1">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" />
                        </svg>
                        Volver al inicio
                    </button>
                </div>
                <div class="p-3 md:p-4 overflow-y-auto md:h-[calc(100vh-105px)]">
                    <ul id="criterios-lista" class="space-y-1.5">
                        </ul>
                </div>
            </nav>

            <main class="flex-1 p-3 md:p-4 lg:p-6 xl:p-8 overflow-y-auto mt-14 md:mt-0">
                <div id="export-container" class="mb-4 md:mb-6" style="display: none;">
                    
                    <div class="mb-3">
                        <label for="export-format-multiple" class="block text-sm font-medium text-gray-700 mb-1">Formato de Puntuación:</label>
                        <select id="export-format-multiple" name="export-format-multiple" class="w-full md:w-auto block py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                            <option value="1">10, 8, 6, 4, 2 (5 niveles)</option>
                            <option value="2">10, 8, 6, 4, 2, 0 (6 niveles, con "No entregado")</option>
                            <option value="3">10, 8.5, 7.5 ... 1.5 (9 niveles)</option>
                            <option value="4">10, 8.5, 7.5 ... 1.5, 0 (10 niveles, con "No entregado")</option>
                        </select>
                    </div>
                    <button id="export-csv-button" class="w-full md:w-auto flex items-center justify-center gap-2 px-4 py-2 md:px-5 md:py-3 rounded-lg bg-green-600 text-white font-medium hover:bg-green-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 shadow-sm">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 md:h-5 md:w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z" clip-rule="evenodd" />
                        </svg>
                        Exportar a Google Classroom (CSV)
                    </button>
                    <div class="text-sm text-gray-600 mt-2">
                        <div class="tooltip-container">
                            <span class="tooltip-trigger">Archivo .csv para llevar a Google Classroom</span>
                            <div class="tooltip-content">
                                <p class="font-semibold mb-2 text-white">Siguientes pasos:</p>
                                <ol class="list-decimal pl-5 space-y-1 text-gray-200">
                                    <li>Exporta el .csv desde la aplicación</li>
                                    <li>Abre una Google Sheet en blanco</li>
                                    <li>Importa el archivo .csv a la Google Sheet</li>
                                    <li>Renombra la Google Sheet, por ejemplo, a "Rúbrica para importar"</li>
                                    <li>Importa la rúbrica desde Classroom</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="rubrics-container" class="space-y-6 md:space-y-8">
                    </div>

                <div id="welcome-message" class="text-center p-6 md:p-8 lg:p-10 bg-white rounded-xl shadow-lg">
                    <svg class="mx-auto h-10 w-10 md:h-12 md:w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    <h3 class="mt-2 text-base md:text-lg font-medium text-gray-800">Selecciona uno o más Criterios</h3>
                    <p class="mt-1 text-xs md:text-sm text-gray-500">Haz clic en los criterios de la barra lateral para ver sus rúbricas. Puedes seleccionar varios a la vez.</p>
                </div>
            </main>
        </div>
    </div>

    <script>
        // =========================================================================
        // === INICIO DE LA ZONA DE EDICIÓN DE DATOS ===
        // =========================================================================
        
        const rubricasData = [
            {
                id: "c1",
                titulo: "TEC.4.1.1. Idear y planificar",
                descripcion: "Idear y planificar soluciones tecnológicas emprendedoras que generen un valor para la comunidad, a partir de la observación y el análisis del entorno más cercano, estudiando sus necesidades, requisitos y posibilidades de mejora.",
                competencia: 1,
                niveles: [
                    { nivel: "(1-2.9)", color: "bg-red-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>En su proyecto, no realiza ninguna observación documentada ni análisis de las necesidades del entorno.</li><li class='pl-2'>No presenta ninguna propuesta de solución tecnológica.</li><li class='pl-2'>No incluye un plan de acción ni lista de recursos necesarios.</li></ul>" },
                    { nivel: "(3-4.9)", color: "bg-orange-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>En su proyecto, realiza observaciones y análisis del entorno, pero no están enfocadas en necesidades o requisitos relevantes.</li><li class='pl-2'>Sus propuestas de solución son poco viables.</li><li class='pl-2'>Sus propuestas de solución son básicas y necesitan más desarrollo.</li><li class='pl-2'>Su plan de acción es limitado, falta detalle y no identifica recursos necesarios.</li></ul>" },
                    { nivel: "(5-6.9)", color: "bg-yellow-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>En su proyecto, realiza observaciones y análisis adecuados del entorno.</li><li class='pl-2'>Propone soluciones tecnológicas viables, aunque pueden necesitar más refinamiento.</li><li class='pl-2'>Presenta un plan de acción básico, pero puede mejorar en detalle y organización.</li><li class='pl-2'>Identifica algunos recursos necesarios.</li></ul>" },
                    { nivel: "(7-8.9)", color: "bg-green-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>En su proyecto, realiza observaciones y análisis exhaustivos del entorno.</li><li class='pl-2'>Sus propuestas de solución son creativas y bien desarrolladas.</li><li class='pl-2'>Su plan de acción es detallado y organizado, considerando la mayoría de los factores importantes.</li><li class='pl-2'>Identifica la mayoría de los recursos necesarios.</li></ul>" },
                    { nivel: "(9-10)", color: "bg-blue-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>En su proyecto, realiza observaciones y análisis exhaustivos, precisos y relevantes del entorno.</li><li class='pl-2'>Sus propuestas de solución son innovadoras, originales y muy bien desarrolladas.</li><li class='pl-2'>Su plan de acción es muy detallado, bien organizado, y considera todos los factores importantes y posibles contratiempos.</li><li class='pl-2'>Identifica todos los recursos necesarios.</li></ul>" }
                ]
            },
            {
                id: "c2",
                titulo: "TEC.4.1.2. Estrategias colaborativas",
                descripcion: "Aplicar con iniciativa estrategias colaborativas de gestión de proyectos con una perspectiva interdisciplinar y siguiendo un proceso iterativo de validación, desde la fase de ideación hasta la difusión de la solución.",
                competencia: 1,
                niveles: [
                    { nivel: "(1-2.9)", color: "bg-red-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>No participa activamente en el proyecto ni aporta ideas o soluciones.</li><li class='pl-2'>No se comunica ni coopera con el resto del equipo.</li><li class='pl-2'>No respeta las normas ni los plazos establecidos.</li><li class='pl-2'>No tiene en cuenta las aportaciones de otras disciplinas ni las necesidades del cliente o usuario.</li><li class='pl-2'>No revisa ni mejora su trabajo ni el del equipo.</li></ul>" },
                    { nivel: "(3-4.9)", color: "bg-orange-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Participa poco en el proyecto y aporta ideas o soluciones poco originales o adecuadas.</li><li class='pl-2'>Se comunica y coopera poco con el resto del equipo.</li><li class='pl-2'>Respeta poco las normas y los plazos establecidos.</li><li class='pl-2'>Tiene poco en cuenta las aportaciones de otras disciplinas y las necesidades del cliente o usuario.</li><li class='pl-2'>Revisa y mejora poco su trabajo y el del equipo.</li></ul>" },
                    { nivel: "(5-6.9)", color: "bg-yellow-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Participa en el proyecto y aporta ideas o soluciones originales y adecuadas.</li><li class='pl-2'>Se comunica y coopera con el resto del equipo.</li><li class='pl-2'>Respeta las normas y los plazos establecidos.</li><li class='pl-2'>Tiene en cuenta las aportaciones de otras disciplinas y las necesidades del cliente o usuario.</li><li class='pl-2'>Revisa y mejora su trabajo y el del equipo.</li></ul>" },
                    { nivel: "(7-8.9)", color: "bg-green-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Participa mucho en el proyecto y aporta ideas o soluciones muy originales y adecuadas.</li><li class='pl-2'>Se comunica y coopera mucho con el resto del equipo.</li><li class='pl-2'>Respeta mucho las normas y los plazos establecidos.</li><li class='pl-2'>Tiene muy en cuenta las aportaciones de otras disciplinas y las necesidades del cliente o usuario.</li><li class='pl-2'>Revisa y mejora mucho su trabajo y el del equipo.</li></ul>" },
                    { nivel: "(9-10)", color: "bg-blue-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Participa excelentemente en el proyecto y aporta ideas o soluciones excelentes y adecuadas.</li><li class='pl-2'>Se comunica y coopera excelentemente con el resto del equipo.</li><li class='pl-2'>Respeta excelentemente las normas y los plazos establecidos.</li><li class='pl-2'>Tiene excelentemente en cuenta las aportaciones de otras disciplinas y las necesidades del cliente o usuario.</li><li class='pl-2'>Revisa y mejora excelentemente su trabajo y el del equipo.</li></ul>" }
                ]
            },
            {
                id: "c3",
                titulo: "TEC.4.1.3. Gestión creativa de proyectos",
                descripcion: "Abordar la gestión del proyecto de forma creativa, aplicando estrategias y técnicas colaborativas adecuadas, así como métodos de investigación en la ideación de soluciones lo más eficientes, accesibles e innovadoras posibles.",
                competencia: 1,
                niveles: [
                    { nivel: "(1-2.9)", color: "bg-red-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>No muestra creatividad en la concepción o el diseño de su proyecto.</li><li class='pl-2'>Raramente participa en actividades grupales y no aporta al trabajo en equipo.</li><li class='pl-2'>No se observan esfuerzos de investigación para la mejora o la eficiencia del proyecto.</li></ul>" },
                    { nivel: "(3-4.9)", color: "bg-orange-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Algunas ideas del proyecto muestran cierta creatividad, pero falta originalidad.</li><li class='pl-2'>Participa en actividades grupales, pero sus contribuciones son mínimas y no siempre aportan al equipo.</li><li class='pl-2'>Se observa una investigación superficial o poco detallada para su proyecto.</li></ul>" },
                    { nivel: "(5-6.9)", color: "bg-yellow-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Su proyecto muestra un pensamiento creativo básico y presenta algunas soluciones innovadoras.</li><li class='pl-2'>Colabora regularmente en actividades de grupo y contribuye de manera básica al trabajo en equipo.</li><li class='pl-2'>Realiza una investigación básica que ha permitido leves mejoras en su proyecto.</li></ul>" },
                    { nivel: "(7-8.9)", color: "bg-green-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Su proyecto es notablemente creativo e incluye varias soluciones innovadoras.</li><li class='pl-2'>A menudo toma la iniciativa en actividades de grupo y su contribución mejora significativamente el rendimiento del equipo.</li><li class='pl-2'>Realiza investigaciones detalladas que conducen a soluciones más eficientes y accesibles en su proyecto.</li></ul>" },
                    { nivel: "(9-10)", color: "bg-blue-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Su proyecto es excepcionalmente creativo, presenta soluciones muy innovadoras que destacan de las demás.</li><li class='pl-2'>Constantemente impulsa y mejora el rendimiento del equipo con su fuerte liderazgo y habilidades colaborativas.</li><li class='pl-2'>Realiza investigaciones exhaustivas y profundas que han llevado a soluciones extremadamente eficientes, accesibles e innovadoras para su proyecto.</li></ul>" }
                ]
            },
            {
                id: "c4",
                titulo: "TEC.4.2.1. Analizar diseño y ciclo de vida",
                descripcion: "Analizar el diseño de un producto que dé respuesta a una necesidad planteada, evaluando su demanda, evolución y previsión de fin de ciclo de vida con un criterio ético, responsable e inclusivo.",
                competencia: 2,
                niveles: [
                    { nivel: "(1-2.9)", color: "bg-red-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>No analiza el diseño del producto ni identifica la necesidad que resuelve.</li><li class='pl-2'>No evalúa su demanda, evolución ni previsión de fin de ciclo de vida.</li><li class='pl-2'>No aplica un criterio ético, responsable e inclusivo</li></ul>" },
                    { nivel: "(3-4.9)", color: "bg-orange-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Analiza superficialmente el diseño del producto y reconoce parcialmente la necesidad que resuelve.</li><li class='pl-2'>Evalúa de forma incompleta o inexacta su demanda, evolución y previsión de fin de ciclo de vida.</li><li class='pl-2'>Aplica un criterio ético, responsable e inclusivo de forma deficiente o inconsistente</li></ul>" },
                    { nivel: "(5-6.9)", color: "bg-yellow-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Analiza correctamente el diseño del producto y identifica la necesidad que resuelve.</li><li class='pl-2'>Evalúa adecuadamente su demanda, evolución y previsión de fin de ciclo de vida.</li><li class='pl-2'>Aplica un criterio ético, responsable e inclusivo de forma coherente y razonada.</li></ul>" },
                    { nivel: "(7-8.9)", color: "bg-green-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Analiza detalladamente el diseño del producto y explica la necesidad que resuelve.</li><li class='pl-2'>Evalúa con precisión su demanda, evolución y previsión de fin de ciclo de vida.</li><li class='pl-2'>Aplica un criterio ético, responsable e inclusivo de forma rigurosa y argumentada.</li></ul>" },
                    { nivel: "(9-10)", color: "bg-blue-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Analiza exhaustivamente el diseño del producto y justifica la necesidad que resuelve.</li><li class='pl-2'>Evalúa con profundidad su demanda, evolución y previsión de fin de ciclo de vida.</li><li class='pl-2'>Aplica un criterio ético, responsable e inclusivo de forma excelente y crítica.</li></ul>" }
                ]
            },
            {
                id: "c5",
                titulo: "TEC.4.2.2. Fabricar productos",
                descripcion: "Fabricar productos y soluciones tecnológicas, aplicando herramientas de diseño asistido, técnicas de elaboración manual, mecánica y digital y utilizando los materiales y recursos adecuados.",
                competencia: 2,
                niveles: [
                    { nivel: "(1-2.9)", color: "bg-red-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>No logra producir un producto o solución tecnológica, o el resultado es inadecuado o inapropiado.</li><li class='pl-2'>No utiliza herramientas de diseño asistido de manera efectiva en la creación del producto.</li><li class='pl-2'>No utiliza adecuadamente técnicas manuales, mecánicas o digitales, y los materiales y recursos mecánicos, eléctricos, electrónicos y digitales seleccionados son inadecuados.</li></ul>" },
                    { nivel: "(3-4.9)", color: "bg-orange-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Produce un producto o solución tecnológica, pero presenta fallos o es inadecuado para la necesidad prevista.</li><li class='pl-2'>Utiliza herramientas de diseño asistido, pero de manera muy limitada or ineficaz.</li><li class='pl-2'>Utiliza algunas técnicas manuales, mecánicas o digitales adecuadamente, y los materiales y recursos mecánicos, eléctricos, electrónicos y digitales utilizados son insuficientes y se podrían mejorar</li></ul>" },
                    { nivel: "(5-6.9)", color: "bg-yellow-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Produce un producto o solución tecnológica que cumple con la necesidad prevista.</li><li class='pl-2'>Utiliza herramientas de diseño asistido de manera efectiva en la creación del producto.</li><li class='pl-2'>Utiliza técnicas manuales, mecánicas y digitales adecuadamente, y los materiales y recursos mecánicos, eléctricos, electrónicos y digitales seleccionados son apropiados, pero admiten mejora.</li></ul>" },
                    { nivel: "(7-8.9)", color: "bg-green-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Produce un producto o solución tecnológica que no solo cumple con la necesidad prevista, sino que muestra elementos de innovación o creatividad.</li><li class='pl-2'>Utiliza herramientas de diseño asistido de manera muy efectiva, y su uso mejora la calidad del producto final.</li><li class='pl-2'>Utiliza técnicas manuales, mecánicas y digitales con gran habilidad, y los materiales y recursos mecánicos, eléctricos, electrónicos y digitales seleccionados son óptimos y aumentan la calidad del producto final.</li></ul>" },
                    { nivel: "(9-10)", color: "bg-blue-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Produce un producto o solución tecnológica que es excepcional en términos de diseño, funcionalidad e innovación.</li><li class='pl-2'>Demuestra un uso maestro de las herramientas de diseño asistido, lo que mejora significativamente la calidad del producto final.</li><li class='pl-2'>Demuestra una gran maestría en el uso de técnicas manuales, mecánicas y digitales, y la selección y uso de materiales y recursos mecánicos, eléctricos, electrónicos y digitales son excepcionales, aportando a la funcionalidad y la innovación del producto final.</li></ul>" }
                ]
            },
            {
                id: "c6",
                titulo: "TEC.4.3.1. Intercambiar información",
                descripcion: "Intercambiar información y fomentar el trabajo en equipo de manera asertiva, empleando las herramientas digitales adecuadas junto con el vocabulario técnico, símbolos y esquemas de sistemas tecnológicos apropiados.",
                competencia: 3,
                niveles: [
                    { nivel: "(1-2.9)", color: "bg-red-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>No intercambia información ni fomenta el trabajo en equipo.</li><li class='pl-2'>No emplea las herramientas digitales adecuadas ni el vocabulario técnico, símbolos y esquemas de sistemas tecnológicos apropiados.</li></ul>" },
                    { nivel: "(3-4.9)", color: "bg-orange-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Intercambia información y fomenta el trabajo en equipo de forma escasa o inadecuada.</li><li class='pl-2'>Emplea las herramientas digitales adecuadas y el vocabulario técnico, símbolos y esquemas de sistemas tecnológicos apropiados de forma deficiente o incompleta.</li></ul>" },
                    { nivel: "(5-6.9)", color: "bg-yellow-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Intercambia información y fomenta el trabajo en equipo de forma adecuada y asertiva.</li><li class='pl-2'>Emplea las herramientas digitales adecuadas y el vocabulario técnico, símbolos y esquemas de sistemas tecnológicos apropiados de forma correcta y completa.</li></ul>" },
                    { nivel: "(7-8.9)", color: "bg-green-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Intercambia información y fomenta el trabajo en equipo de forma eficaz y asertiva.</li><li class='pl-2'>Emplea las herramientas digitales adecuadas y el vocabulario técnico, símbolos y esquemas de sistemas tecnológicos apropiados de forma óptima y precisa.</li></ul>" },
                    { nivel: "(9-10)", color: "bg-blue-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Intercambia información y fomenta el trabajo en equipo de forma excelente y asertiva.</li><li class='pl-2'>Emplea las herramientas digitales adecuadas y el vocabulario técnico, símbolos y esquemas de sistemas tecnológicos apropiados de forma excelente y creativa.</li></ul>" }
                ]
            },
            {
                id: "c7",
                titulo: "TEC.4.3.2. Presentar y difundir",
                descripcion: "Presentar y difundir las propuestas o soluciones tecnológicas de manera efectiva, empleando la entonación, expresión, gestión del tiempo y adaptación adecuada del discurso, así como un lenguaje inclusivo y no sexista.",
                competencia: 3,
                niveles: [
                    { nivel: "(1-2.9)", color: "bg-red-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>La presentación es confusa, desorganizada y no se ajusta al tiempo establecido.</li><li class='pl-2'>La entonación y la expresión son monótonas y no transmiten interés ni seguridad.</li><li class='pl-2'>El discurso es incoherente, irrelevante o incompleto.</li><li class='pl-2'>El lenguaje es excluyente y sexista.</li></ul>" },
                    { nivel: "(3-4.9)", color: "bg-orange-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>La presentación es poco clara, poco estructurada y se desvía del tiempo establecido.</li><li class='pl-2'>La entonación y la expresión son poco variadas y transmiten poco interés o seguridad.</li><li class='pl-2'>El discurso es poco coherente, poco relevante o poco completo.</li><li class='pl-2'>El lenguaje es poco inclusivo y poco respetuoso con la diversidad.</li></ul>" },
                    { nivel: "(5-6.9)", color: "bg-yellow-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>La presentación es clara, estructurada y se ajusta aproximadamente al tiempo establecido.</li><li class='pl-2'>La entonación y la expresión son adecuadas y transmiten interés y seguridad.</li><li class='pl-2'>El discurso es coherente, relevante y completo.</li><li class='pl-2'>El lenguaje es inclusivo y respeta la diversidad.</li></ul>" },
                    { nivel: "(7-8.9)", color: "bg-green-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>La presentación es muy clara, muy estructurada y se ajusta al tiempo establecido.</li><li class='pl-2'>La entonación y la expresión son variadas y transmiten mucho interés y seguridad.</li><li class='pl-2'>El discurso es muy coherente, muy relevante y muy completo.</li><li class='pl-2'>El lenguaje es muy inclusivo y muy respetuoso con la diversidad.</li></ul>" },
                    { nivel: "(9-10)", color: "bg-blue-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>La presentación es excelente, creativa y se ajusta al tiempo establecido con precisión.</li><li class='pl-2'>La entonación y la expresión son dinámicas y transmiten entusiasmo y confianza.</li><li class='pl-2'>El discurso es excelente, original y exhaustivo.</li><li class='pl-2'>El lenguaje es excelente, inclusivo y respetuoso con la diversidad en todo momento.</li></ul>" }
                ]
            },
            {
                id: "c8",
                titulo: "TEC.4.4.1. Diseñar sistemas automáticos",
                descripcion: "Diseñar, construir, controlar y simular sistemas automáticos programables y robots que sean capaces de realizar tareas de forma autónoma, aplicando conocimientos de mecánica, electrónica, neumática y componentes de los sistemas de control, así como otros conocimientos interdisciplinares.",
                competencia: 4,
                niveles: [
                    { nivel: "(1-2.9)", color: "bg-red-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>No realiza ni entrega los proyectos y/o prácticas de sistemas automáticos programables y robots o los hace con errores graves.</li><li class='pl-2'>No sabe qué son ni cómo funciona la mecánica y/o electrónica y/o neumática y/o los componentes de los sistemas de control.</li><li class='pl-2'>No relaciona los contenidos de tecnología con otras materias.</li></ul>" },
                    { nivel: "(3-4.9)", color: "bg-orange-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Realiza y entrega los proyectos y/o prácticas de sistemas automáticos programables y robots con retraso o con errores significativos.</li><li class='pl-2'>Sabe qué son algunos elementos de la mecánica y/o electrónica y/o neumática y/o los componentes de los sistemas de control, pero no cómo funcionan.</li><li class='pl-2'>Relaciona los contenidos de tecnología con otras materias de forma superficial o incompleta.</li></ul>" },
                    { nivel: "(5-6.9)", color: "bg-yellow-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Realiza y entrega los proyectos y/o prácticas de sistemas automáticos programables y robots en el plazo establecido y con pocos errores.</li><li class='pl-2'>Sabe qué son y cómo funcionan los elementos básicos de la mecánica y/o electrónica y/o neumática y/o los componentes de los sistemas de control.</li><li class='pl-2'>Relaciona los contenidos de tecnología con otras materias de forma adecuada y coherente.</li></ul>" },
                    { nivel: "(7-8.9)", color: "bg-green-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Realiza y entrega los proyectos y/o prácticas de sistemas automáticos programables y robots en el plazo establecido y sin errores.</li><li class='pl-2'>Sabe qué son y cómo funcionan varios elementos avanzados de la mecánica y/o electrónica y/o neumática y/o los componentes de los sistemas de control.</li><li class='pl-2'>Relaciona los contenidos de tecnología con otras materias de forma amplia y profunda.</li></ul>" },
                    { nivel: "(9-10)", color: "bg-blue-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Realiza y entrega los proyectos y/o prácticas de sistemas automáticos programables y robots en el plazo establecido y con un nivel superior al esperado.</li><li class='pl-2'>Sabe qué son y cómo funcionan diversos elementos innovadores o creativos de la mecánica y/o electrónica y/o neumática y/o los componentes de los sistemas de control.</li><li class='pl-2'>Relaciona los contenidos de tecnología con otras materias crítica y reflexivamente.</li></ul>" }
                ]
            },
            {
                id: "c9",
                titulo: "TEC.4.4.2. Integrar tecnologías emergentes",
                descripcion: "Integrar en las máquinas y sistemas tecnológicos aplicaciones informáticas y tecnologías digitales emergentes de control y simulación como el internet de las cosas, el big data y la inteligencia artificial con sentido crítico y ético.",
                competencia: 4,
                niveles: [
                    { nivel: "(1-2.9)", color: "bg-red-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>No identifica ni utiliza las aplicaciones informáticas y tecnologías digitales de control y simulación en las máquinas y sistemas tecnológicos.</li><li class='pl-2'>No realiza ningún intento por incorporar una aplicación de IoT, Big Data o IA en un proyecto y/o práctica, ni muestra interés por entender su uso ético y seguro.</li></ul>" },
                    { nivel: "(3-4.9)", color: "bg-orange-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Identifica algunas aplicaciones informáticas y tecnologías digitales de control y simulación en las máquinas y sistemas tecnológicos, pero no las utiliza adecuadamente.</li><li class='pl-2'>Intenta incorporar una aplicación de IoT en un proyecto y/o práctica, pero no logra conectarla ni operar correctamente.</li><li class='pl-2'>Muestra una comprensión limitada del uso ético y seguro de estos dispositivos.</li></ul>" },
                    { nivel: "(5-6.9)", color: "bg-yellow-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Identifica y utiliza correctamente algunas aplicaciones informáticas y tecnologías digitales de control y simulación en las máquinas y sistemas tecnológicos.</li><li class='pl-2'>Configura e integra de modo muy básico una aplicación de IoT en un proyecto y/o práctica, demostrando un uso ético y seguro muy básico de la tecnología.</li></ul>" },
                    { nivel: "(7-8.9)", color: "bg-green-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Identifica y utiliza correctamente y con autonomía varias aplicaciones informáticas y tecnologías digitales de control y simulación en las máquinas y sistemas tecnológicos.</li><li class='pl-2'>Configura e integra una aplicación de IoT y utiliza Big Data or IA en un proyecto o práctica más complejo/a, demostrando un uso ético y seguro avanzado de estas tecnologías.</li></ul>" },
                    { nivel: "(9-10)", color: "bg-blue-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Identifica y utiliza correctamente y con creatividad diversas aplicaciones informáticas y tecnologías digitales de control y simulación en las máquinas y sistemas tecnológicos.</li><li class='pl-2'>Configura e integra de manera innovadora y avanzada aplicaciones de IoT, Big Data e IA en un proyecto y/o práctica complejo/a y original, demostrando un alto nivel de uso ético y seguro de estas tecnologías.</li></ul>" }
                ]
            },
            {
                id: "c10",
                titulo: "TEC.4.5.1. Resolver tareas con herramientas digitales",
                descripcion: "Resolver tareas propuestas de manera eficiente mediante el uso y configuración de diferentes aplicaciones y herramientas digitales, aplicando conocimientos interdisciplinares con autonomía.",
                competencia: 5,
                niveles: [
                    { nivel: "(1-2.9)", color: "bg-red-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>No entrega las tareas o las hace con errores graves.</li><li class='pl-2'>No realiza ningún intento de uso de herramientas digitales para completar las tareas asignadas en clase.</li><li class='pl-2'>No se observa evidencia de trabajo o esfuerzo en las actividades asignadas.</li></ul>" },
                    { nivel: "(3-4.9)", color: "bg-orange-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Entrega las tareas con retraso o con errores significativos.</li><li class='pl-2'>Intenta usar una herramienta digital para completar una tarea en clase pero necesita ayuda constante y su resultado final es incompleto.</li><li class='pl-2'>Se puede ver un intento en las actividades, aunque su aplicación de conocimientos es muy limitada</li></ul>" },
                    { nivel: "(5-6.9)", color: "bg-yellow-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Entrega las tareas en el plazo establecido y con pocos errores.</li><li class='pl-2'>Sabe usar y configurar las aplicaciones y herramientas digitales que se le indican, siguiendo instrucciones o ejemplos dados pero de modo básico.</li><li class='pl-2'>Relaciona los contenidos de tecnología con otras materias de forma básica.</li><li class='pl-2'>Trabaja por su cuenta cuando es necesario, pero no siempre.</li></ul>" },
                    { nivel: "(7-8.9)", color: "bg-green-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Entrega las tareas en el plazo establecido y sin errores.</li><li class='pl-2'>Demuestra un uso eficiente y autónomo de diferentes herramientas digitales para completar tareas en clase y su aplicación interdisciplinaria de conocimientos es clara.</li><li class='pl-2'>Trabaja por su cuenta con iniciativa y responsabilidad.</li></ul>" },
                    { nivel: "(9-10)", color: "bg-blue-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Entrega las tareas en el plazo establecido y con un nivel superior al esperado.</li><li class='pl-2'>Utiliza de manera experta y creativa diversas herramientas digitales para resolver tareas de clase, aplicando conocimientos interdisciplinares de manera innovadora.</li><li class='pl-2'>Relaciona los contenidos de tecnología con otras materias de forma crítica y reflexiva.</li><li class='pl-2'>Trabaja por su cuenta con proactividad e independencia.</li></ul>" }
                ]
            },
            {
                id: "c11",
                titulo: "TEC.4.6.1. Uso responsable de la tecnología",
                descripcion: "Hacer un uso responsable de la tecnología, mediante el análisis y aplicación de criterios de sostenibilidad y accesibilidad en la selección de materiales y en el diseño de estos, así como en los procesos de fabricación de productos tecnológicos, minimizando el impacto negativo en la sociedad y en el planeta.",
                competencia: 6,
                niveles: [
                    { nivel: "(1-2.9)", color: "bg-red-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>No reconoce el concepto de sostenibilidad y accesibilidad y no puede identificar estos criterios en el uso de materiales o desarrollo de procesos tecnológicos.</li><li class='pl-2'>No respeta las normas de seguridad e higiene en el taller.</li></ul>" },
                    { nivel: "(3-4.9)", color: "bg-orange-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Selecciona e identifica algunos materiales y procesos tecnológicos sostenibles y accesibles pero tiene dificultades para aplicar estos conceptos en su trabajo.</li><li class='pl-2'>Respeta las normas de seguridad e higiene en el taller solo cuando se le recuerda.</li></ul>" },
                    { nivel: "(5-6.9)", color: "bg-yellow-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Selecciona materiales sostenibles y accesibles para un proyecto o práctica simple.</li><li class='pl-2'>Además, muestra un entendimiento básico de cómo su proceso de trabajo pode minimizar el impacto negativo en la sociedad y el planeta.</li><li class='pl-2'>Respeta las normas de seguridad e higiene en el taller siempre que se le indica.</li></ul>" },
                    { nivel: "(7-8.9)", color: "bg-green-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Selecciona e implementa materiales sostenibles y accesibles en un proyecto o práctica de mediana complejidad.</li><li class='pl-2'>Además, muestra un entendimiento avanzado de cómo su proceso de trabalho pode minimizar el impacto negativo en la sociedad y el planeta.</li><li class='pl-2'>Respeta las normas de seguridad e higiene en el taller con iniciativa y responsabilidad.</li></ul>" },
                    { nivel: "(9-10)", color: "bg-blue-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Selecciona, implementa y justifica el uso de materiales sostenibles y accesibles en un proyecto de alta complejidad o en una práctica avanzada.</li><li class='pl-2'>Demuestra constantemente cómo su proceso de trabajo minimiza el impacto negativo en la sociedad y el planeta, y hace propuestas para mejorar la sostenibilidad y accesibilidad en futuros proyectos.</li><li class='pl-2'>Respeta las normas de seguridad e higiene en el taller con proactividad e independencia.</li></ul>" }
                ]
            },
            {
                id: "c12",
                titulo: "TEC.4.6.2. Analizar arquitectura bioclimática",
                descripcion: "Analizar los beneficios que, en el cuidado del entorno, aportan la arquitectura bioclimática y el ecotransporte, valorando la contribución de las tecnologías al desarrollo sostenible.",
                competencia: 6,
                niveles: [
                    { nivel: "(1-2.9)", color: "bg-red-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>No muestra comprensión alguna de los conceptos de arquitectura bioclimática y ecotransporte, y no es capaz de identificar su relación con el cuidado del entorno y el desarrollo sostenible.</li></ul>" },
                    { nivel: "(3-4.9)", color: "bg-orange-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Muestra una mínima comprensión de los conceptos de arquitectura bioclimática y ecotransporte, y sus beneficios para el cuidado del entorno, pero tiene dificultades para conectar estos conceptos con el desarrollo sostenible.</li></ul>" },
                    { nivel: "(5-6.9)", color: "bg-yellow-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Muestra una aceptable comprensión de los conceptos de arquitectura bioclimática y ecotransporte y es capaz de describir los beneficios de la arquitectura bioclimática y el ecotransporte para el cuidado del entorno.</li><li class='pl-2'>Muestra una comprensión básica de cómo estas tecnologías pueden contribuir al desarrollo sostenible.</li></ul>" },
                    { nivel: "(7-8.9)", color: "bg-green-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Muestra una notable comprensión de los conceptos de arquitectura bioclimática y ecotransporte y es capaz de describir cómo influyen en el medio ambiente, dando ejemplos concretos o reales.</li><li class='pl-2'>Reconoce el papel de diversas tecnologías para mejorar la calidad de vida de las personas y el planeta, dando ejemplos concretos o reales.</li></ul>" },
                    { nivel: "(9-10)", color: "bg-blue-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Muestra una sobresaliente comprensión de los conceptos de arquitectura bioclimática y ecotransporte y cómo influyen en el medio ambiente, dando ejemplos originales o creativos.</li><li class='pl-2'>Reconoce el papel de diversas tecnologías para mejorar la calidad de vida de las personas y el planeta, dando ejemplos originales o creativos.</li></ul>" }
                ]
            },
            {
                id: "c13",
                titulo: "TEC.4.6.3. Valorar proyectos sociales",
                descripcion: "Identificar y valorar la repercusión y los beneficios del desarrollo de proyectos tecnológicos de carácter social, por medio de comunidades abiertas, acciones de voluntariado o proyectos de servicio a la comunidad.",
                competencia: 6,
                niveles: [
                    { nivel: "(1-2.9)", color: "bg-red-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>No identifica ni valora la repercusión y los beneficios del desarrollo de proyectos tecnológicos de carácter social, por medio de comunidades abiertas, acciones de voluntariado o proyectos de servicio a la comunidad.</li><li class='pl-2'>Por ejemplo, no sabe qué son ni para qué sirven estos tipos de proyectos.</li><li class='pl-2'>No muestra interés ni participación en ellos.</li></ul>" },
                    { nivel: "(3-4.9)", color: "bg-orange-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Identifica y valora parcialmente la repercusión y los beneficios del desarrollo de proyectos tecnológicos de carácter social, por medio de comunidades abiertas, acciones de voluntariado o proyectos de servicio a la comunidad.</li><li class='pl-2'>Por ejemplo, sabe qué son algunos de estos tipos de proyectos, pero no para qué sirven.</li><li class='pl-2'>Muestra poco interés y participación en ellos.</li></ul>" },
                    { nivel: "(5-6.9)", color: "bg-yellow-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Identifica y valora correctamente la repercusión y los beneficios del desarrollo de proyectos tecnológicos de carácter social, por medio de comunidades abiertas, acciones de voluntariado o proyectos de servicio a la comunidad.</li><li class='pl-2'>Por ejemplo, sabe qué son y para qué sirven estos tipos de proyectos.</li><li class='pl-2'>Muestra interés y participación en ellos cuando se le indica.</li></ul>" },
                    { nivel: "(7-8.9)", color: "bg-green-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Identifica y valora muy bien la repercusión y los beneficios del desarrollo de proyectos tecnológicos de carácter social, por medio de comunidades abiertas, actions de voluntariado o proyectos de servicio a la comunidad.</li><li class='pl-2'>Por ejemplo, sabe qué son y para qué sirven estos tipos de proyectos, dando ejemplos concretos o reales.</li><li class='pl-2'>Muestra interés y participación en ellos con iniciativa y responsabilidad.</li></ul>" },
                    { nivel: "(9-10)", color: "bg-blue-50", descriptor: "<ul class='list-disc list-inside space-y-1'><li class='pl-2'>Identifica y valora excelentemente la repercusión y los beneficios del desarrollo de proyectos tecnológicos de carácter social, por medio de comunidades abiertas, acciones de voluntariado o proyectos de servicio a la comunidad.</li><li class='pl-2'>Por ejemplo, sabe qué son y para qué sirven estos tipos de proyectos, dando ejemplos originales o creativos.</li><li class='pl-2'>Muestra interés y participación en ellos con proactividad e independencia.</li></ul>" }
                ]
            }
        ];

        // Definición de competencias específicas
        const competenciasData = [
            {
                id: 1,
                titulo: "TEC.4.1. Identificar y proponer problemas tecnológicos",
                descripcion: "Identificar y proponer problemas tecnológicos con iniciativa y creatividad, estudiando las necesidades de su entorno próximo y aplicando estrategias y procesos colaborativos e iterativos relativos a proyectos, para idear y planificar soluciones de manera eficiente, accesible, sostenible e innovadora.",
                icono: `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd" />
                </svg>`
            },
            {
                id: 2,
                titulo: "TEC.4.2. Aplicar técnicas y conocimientos interdisciplinares",
                descripcion: "Aplicar de forma apropiada y segura distintas técnicas y conocimientos interdisciplinares, utilizando procedimientos y recursos tecnológicos y analizando el ciclo de vida de productos para fabricar soluciones tecnológicas accesibles y sostenibles que den respuesta a necesidades planteadas.",
                icono: `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z" clip-rule="evenodd" />
                </svg>`
            },
            {
                id: 3,
                titulo: "TEC.4.3. Expresar, comunicar y difundir ideas",
                descripcion: "Expresar, comunicar y difundir ideas, propuestas o soluciones tecnológicas en diferentes foros de manera efectiva, usando un lenguaje inclusivo y no sexista, empleando los recursos disponibles y aplicando los elementos y técnicas necesarias, para intercambiar la información de manera responsable y fomentar el trabajo en equipo.",
                icono: `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M18 5v8a2 2 0 01-2 2h-5l-5 4v-4H4a2 2 0 01-2-2V5a2 2 0 012-2h12a2 2 0 012 2zM7 8H5v2h2V8zm2 0h2v2H9V8zm6 0h-2v2h2V8z" clip-rule="evenodd" />
                </svg>`
            },
            {
                id: 4,
                titulo: "TEC.4.4. Desarrollar soluciones automatizadas",
                descripcion: "Desarrollar soluciones automatizadas a problemas planteados, aplicando los conocimientos necesarios e incorporando tecnologías emergentes, para diseñar y construir sistemas de control programables y robóticos.",
                icono: `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM6.75 9.25a.75.75 0 000 1.5h6.5a.75.75 0 000-1.5h-6.5z" clip-rule="evenodd" />
                </svg>`
            },
            {
                id: 5,
                titulo: "TEC.4.5. Aprovechar herramientas digitales",
                descripcion: "Aprovechar y emplear de manera responsable las posibilidades de las herramientas digitales, adaptándolas a sus necesidades, configurándolas y aplicando conocimientos interdisciplinares, para la resolución de tareas de una manera más eficiente.",
                icono: `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M2 5a2 2 0 012-2h12a2 2 0 012 2v10a2 2 0 01-2 2H4a2 2 0 01-2-2V5zm3.293 1.293a1 1 0 011.414 0l3 3a1 1 0 010 1.414l-3 3a1 1 0 01-1.414-1.414L7.586 10 5.293 7.707a1 1 0 010-1.414zM11 12a1 1 0 100 2h3a1 1 0 100-2h-3z" clip-rule="evenodd" />
                </svg>`
            },
            {
                id: 6,
                titulo: "TEC.4.6. Analizar procesos tecnológicos",
                descripcion: "Analizar procesos tecnológicos, teniendo en cuenta su impacto en la sociedad y el entorno, aplicando criterios de sostenibilidad y accesibilidad para hacer un uso ético y ecosocialmente responsable de la tecnología.",
                icono: `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M12 1.586l-4 4v12.828l4-4V1.586zM3.707 3.293A1 1 0 002 4v10a1 1 0 00.293.707L6 18.414V5.586L3.707 3.293zM17.707 5.293A1 1 0 0118 6v10a1 1 0 01-.293.707L14 18.414V5.586l3.707-3.293z" clip-rule="evenodd" />
                </svg>`
            }
        ];
        
        // =========================================================================
        // === FIN DE LA ZONA DE EDICIÓN DE DATOS ===
        // =========================================================================
        

        // --- LÓGICA DE LA APLICACIÓN ---

        // Elementos de la pantalla principal
        const mainScreenEl = document.getElementById('main-screen');
        const btnCompetenciasEl = document.getElementById('btn-competencias');
        const btnMultipleEl = document.getElementById('btn-multiple');

        // Elementos de la pantalla de competencias
        const competenciasScreenEl = document.getElementById('competencias-screen');
        const competenciasListaEl = document.getElementById('competencias-lista');
        const rubricsContainerCompetenciasEl = document.getElementById('rubrics-container-competencias');
        const welcomeMessageCompetenciasEl = document.getElementById('welcome-message-competencias');
        const exportContainerCompetenciasEl = document.getElementById('export-container-competencias');
        const exportButtonCompetenciasEl = document.getElementById('export-csv-button-competencias');
        const backFromCompetenciasEl = document.getElementById('back-from-competencias');
        const mobileMenuBtnCompetenciasEl = document.getElementById('mobile-menu-btn-competencias');
        const sidebarCompetenciasEl = document.getElementById('sidebar-competencias');
        const closeSidebarCompetenciasEl = document.getElementById('close-sidebar-competencias');
        const overlayCompetenciasEl = document.getElementById('overlay-competencias');

        // Elementos de la pantalla de selección múltiple
        const multipleScreenEl = document.getElementById('multiple-screen');
        const criteriosListaEl = document.getElementById('criterios-lista');
        const rubricsContainerEl = document.getElementById('rubrics-container');
        const welcomeMessageEl = document.getElementById('welcome-message');
        const exportContainerEl = document.getElementById('export-container');
        const exportButtonEl = document.getElementById('export-csv-button');
        const backFromMultipleEl = document.getElementById('back-from-multiple');
        const mobileMenuBtnMultipleEl = document.getElementById('mobile-menu-btn-multiple');
        const sidebarMultipleEl = document.getElementById('sidebar-multiple');
        const closeSidebarMultipleEl = document.getElementById('close-sidebar-multiple');
        const overlayMultipleEl = document.getElementById('overlay-multiple');

        // Estado para guardar las selecciones
        let selectedCompetencia = null;
        let selectedCriterios = [];

        /**
         * Inicializa la aplicación cuando el DOM está cargado.
         */
        document.addEventListener('DOMContentLoaded', () => {
            // Configurar eventos de navegación
            btnCompetenciasEl.addEventListener('click', showCompetenciasScreen);
            btnMultipleEl.addEventListener('click', showMultipleScreen);
            backFromCompetenciasEl.addEventListener('click', showMainScreen);
            backFromMultipleEl.addEventListener('click', showMainScreen);
            
            // Eventos para menú móvil - competencias
            mobileMenuBtnCompetenciasEl.addEventListener('click', () => {
                sidebarCompetenciasEl.classList.add('open');
                overlayCompetenciasEl.classList.add('open');
            });
            
            closeSidebarCompetenciasEl.addEventListener('click', closeSidebarCompetencias);
            overlayCompetenciasEl.addEventListener('click', closeSidebarCompetencias);
            
            // Eventos para menú móvil - múltiple
            mobileMenuBtnMultipleEl.addEventListener('click', () => {
                sidebarMultipleEl.classList.add('open');
                overlayMultipleEl.classList.add('open');
            });
            
            closeSidebarMultipleEl.addEventListener('click', closeSidebarMultiple);
            overlayMultipleEl.addEventListener('click', closeSidebarMultiple);
            
            // Inicializar pantallas
            populateCompetenciasSidebar();
            populateCriteriosSidebar();

            // ===== INICIO: CÓDIGO MODIFICADO =====
            // Se actualizan los listeners para que lean el formato del selector
            
            exportButtonEl.addEventListener('click', () => {
                const format = document.getElementById('export-format-multiple').value;
                const criteriaToExport = rubricasData.filter(c => selectedCriterios.includes(c.id));
                generateAndDownloadCSV(criteriaToExport, format);
            });
            
            exportButtonCompetenciasEl.addEventListener('click', () => {
                const format = document.getElementById('export-format-competencias').value;
                const criteriaToExport = rubricasData.filter(c => c.competencia == selectedCompetencia);
                generateAndDownloadCSV(criteriaToExport, format);
            });
            // ===== FIN: CÓDIGO MODIFICADO =====
        });

        /**
         * Cierra el sidebar en la pantalla de competencias
         */
        function closeSidebarCompetencias() {
            sidebarCompetenciasEl.classList.remove('open');
            overlayCompetenciasEl.classList.remove('open');
        }

        /**
         * Cierra el sidebar en la pantalla de selección múltiple
         */
        function closeSidebarMultiple() {
            sidebarMultipleEl.classList.remove('open');
            overlayMultipleEl.classList.remove('open');
        }

        /**
         * Muestra la pantalla principal.
         */
        function showMainScreen() {
            mainScreenEl.style.display = 'flex';
            competenciasScreenEl.style.display = 'none';
            multipleScreenEl.style.display = 'none';
            
            // Cerrar sidebars si están abiertos
            closeSidebarCompetencias();
            closeSidebarMultiple();
        }

        /**
         * Muestra la pantalla de competencias.
         */
        function showCompetenciasScreen() {
            mainScreenEl.style.display = 'none';
            competenciasScreenEl.style.display = 'flex';
            multipleScreenEl.style.display = 'none';
            
            // Reiniciar selección
            selectedCompetencia = null;
            renderSelectedCompetenciaRubrics();
            
            // Cerrar sidebar si está abierto
            closeSidebarCompetencias();
        }

        /**
         * Muestra la pantalla de selección múltiple.
         */
        function showMultipleScreen() {
            mainScreenEl.style.display = 'none';
            competenciasScreenEl.style.display = 'none';
            multipleScreenEl.style.display = 'flex';
            
            // Reiniciar selección
            selectedCriterios = [];
            renderSelectedRubrics();
            
            // Cerrar sidebar si está abierto
            closeSidebarMultiple();
        }

        /**
         * Rellena la barra lateral con los botones de las competencias.
         */
        function populateCompetenciasSidebar() {
            if (!competenciasListaEl) return;
            
            competenciasListaEl.innerHTML = '';
            
            competenciasData.forEach(competencia => {
                const li = document.createElement('li');
                const button = document.createElement('button');
                // Cambiado el color de fondo para distinguir competencias específicas
                button.className = "w-full text-left py-2 md:py-2.5 px-4 rounded-lg bg-blue-50 text-blue-800 hover:bg-blue-100 hover:text-blue-900 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 flex items-center gap-1 md:gap-2 break-words";
                button.innerHTML = `${competencia.icono}<span class="text-sm md:text-base">${competencia.titulo}</span>`;
                button.setAttribute('data-id', competencia.id);
                
                button.addEventListener('click', () => {
                    toggleCompetencia(competencia.id, button);
                    // En móvil, cerrar el sidebar después de seleccionar
                    if (window.innerWidth < 768) {
                        closeSidebarCompetencias();
                    }
                });
                
                li.appendChild(button);
                competenciasListaEl.appendChild(li);
            });
        }

        /**
         * Rellena la barra lateral con los botones de los criterios.
         */
        function populateCriteriosSidebar() {
            if (!criteriosListaEl) return;
            
            criteriosListaEl.innerHTML = '';
            
            rubricasData.forEach(criterio => {
                const li = document.createElement('li');
                const button = document.createElement('button');
                // Mantenido el estilo original para los criterios
                button.className = "w-full text-left py-2 md:py-2.5 px-4 rounded-lg text-gray-700 hover:bg-gray-100 hover:text-blue-600 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 flex items-center gap-1 md:gap-2 break-words";
                
                // Añadir icono según el tipo de criterio
                let iconoHTML = '';
                if (criterio.titulo.includes('Idear') || criterio.titulo.includes('Estrategias') || criterio.titulo.includes('Gestión')) {
                    iconoHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 md:h-4 md:w-4" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z" clip-rule="evenodd" />
                    </svg>`;
                } else if (criterio.titulo.includes('Analizar') || criterio.titulo.includes('Fabricar')) {
                    iconoHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 md:h-4 md:w-4" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM6.75 9.25a.75.75 0 000 1.5h6.5a.75.75 0 000-1.5h-6.5z" clip-rule="evenodd" />
                    </svg>`;
                } else if (criterio.titulo.includes('Intercambiar') || criterio.titulo.includes('Presentar')) {
                    iconoHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 md:h-4 md:w-4" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M18 5v8a2 2 0 01-2 2h-5l-5 4v-4H4a2 2 0 01-2-2V5a2 2 0 012-2h12a2 2 0 012 2zM7 8H5v2h2V8zm2 0h2v2H9V8zm6 0h-2v2h2V8z" clip-rule="evenodd" />
                    </svg>`;
                } else if (criterio.titulo.includes('Diseñar') || criterio.titulo.includes('Integrar')) {
                    iconoHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 md:h-4 md:w-4" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03zM12.12 15.12A3 3 0 017 13s.879.5 2.5.5c0-1 .5-4 1.25-4.5.5 1 .786 1.293 1.371 1.879A2.99 2.99 0 0113 13a2.99 2.99 0 01-.879 2.121z" clip-rule="evenodd" />
                    </svg>`;
                } else if (criterio.titulo.includes('Resolver')) {
                    iconoHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 md:h-4 md:w-4" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                    </svg>`;
                } else if (criterio.titulo.includes('Uso responsable') || criterio.titulo.includes('Valorar')) {
                    iconoHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 md:h-4 md:w-4" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                    </svg>`;
                } else {
                    iconoHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 md:h-4 md:w-4" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z" clip-rule="evenodd" />
                    </svg>`;
                }
                
                button.innerHTML = `${iconoHTML}<span class="text-sm md:text-base">${criterio.titulo}</span>`;
                button.setAttribute('data-id', criterio.id);
                
                button.addEventListener('click', () => {
                    toggleCriterio(criterio.id, button);
                    // En móvil, cerrar el sidebar después de seleccionar
                    if (window.innerWidth < 768) {
                        closeSidebarMultiple();
                    }
                });
                
                li.appendChild(button);
                criteriosListaEl.appendChild(li);
            });
        }

        /**
         * Selecciona una competencia y actualiza la vista.
         */
        function toggleCompetencia(competenciaId, buttonEl) {
            // Si ya está seleccionada, deseleccionar
            if (selectedCompetencia === competenciaId) {
                selectedCompetencia = null;
                updateButtonStyle(buttonEl, false, 'competencia');
            } else {
                // Deseleccionar cualquier competencia anterior
                const buttons = competenciasListaEl.querySelectorAll('button');
                buttons.forEach(btn => {
                    updateButtonStyle(btn, false, 'competencia');
                });
                
                // Seleccionar la nueva competencia
                selectedCompetencia = competenciaId;
                updateButtonStyle(buttonEl, true, 'competencia');
            }
            
            renderSelectedCompetenciaRubrics();
        }

        /**
         * Añade o quita un criterio de la selección y actualiza la vista.
         */
        function toggleCriterio(criterioId, buttonEl) {
            const index = selectedCriterios.indexOf(criterioId);
            
            if (index > -1) {
                selectedCriterios.splice(index, 1);
                updateButtonStyle(buttonEl, false, 'criterio');
            } else {
                selectedCriterios.push(criterioId);
                updateButtonStyle(buttonEl, true, 'criterio');
            }
            
            renderSelectedRubrics();
        }

        /**
         * Actualiza el estado visual de un botón (activo o inactivo).
         */
        function updateButtonStyle(buttonEl, isActive, type) {
            if (type === 'competencia') {
                if (isActive) {
                    buttonEl.classList.add('bg-blue-600', 'text-white', 'font-semibold');
                    buttonEl.classList.remove('bg-blue-50', 'text-blue-800', 'hover:bg-blue-100', 'hover:text-blue-900');
                } else {
                    buttonEl.classList.remove('bg-blue-600', 'text-white', 'font-semibold');
                    buttonEl.classList.add('bg-blue-50', 'text-blue-800', 'hover:bg-blue-100', 'hover:text-blue-900');
                }
            } else { // criterio
                if (isActive) {
                    buttonEl.classList.add('bg-blue-600', 'text-white', 'font-semibold');
                    buttonEl.classList.remove('text-gray-700', 'hover:bg-gray-100', 'hover:text-blue-600');
                } else {
                    buttonEl.classList.remove('bg-blue-600', 'text-white', 'font-semibold');
                    buttonEl.classList.add('text-gray-700', 'hover:bg-gray-100', 'hover:text-blue-600');
                }
            }
        }

        /**
         * Renderiza las rúbricas de la competencia seleccionada en el panel principal.
         */
        function renderSelectedCompetenciaRubrics() {
            rubricsContainerCompetenciasEl.innerHTML = '';
            
            if (selectedCompetencia === null) {
                welcomeMessageCompetenciasEl.style.display = 'block';
                exportContainerCompetenciasEl.style.display = 'none';
            } else {
                welcomeMessageCompetenciasEl.style.display = 'none';
                exportContainerCompetenciasEl.style.display = 'block';
                
                // Encontrar la competencia seleccionada
                const competencia = competenciasData.find(c => c.id == selectedCompetencia);
                
                // Añadir información de la competencia con el mismo formato azul que el botón seleccionado
                const competenciaHTML = `
                    <div class="bg-blue-600 text-white p-4 md:p-5 lg:p-8 rounded-xl shadow-lg transition-all duration-300 mb-6 md:mb-8">
                        <h2 class="text-xl md:text-2xl lg:text-3xl font-bold mb-3">${competencia.titulo}</h2>
                        <p class="text-sm md:text-base text-blue-100">${competencia.descripcion}</p>
                    </div>
                `;
                rubricsContainerCompetenciasEl.innerHTML += competenciaHTML;
                
                // Añadir los criterios de esta competencia
                rubricasData.forEach(criterio => {
                    if (criterio.competencia == selectedCompetencia) {
                        const rubricHTML = createRubricHTML(criterio);
                        rubricsContainerCompetenciasEl.innerHTML += rubricHTML;
                    }
                });
            }
        }

        /**
         * Renderiza las rúbricas de todos los criterios seleccionados en el panel principal.
         */
        function renderSelectedRubrics() {
            rubricsContainerEl.innerHTML = '';
            
            if (selectedCriterios.length === 0) {
                welcomeMessageEl.style.display = 'block';
                exportContainerEl.style.display = 'none';
            } else {
                welcomeMessageEl.style.display = 'none';
                exportContainerEl.style.display = 'block';
                
                rubricasData.forEach(criterio => {
                    if (selectedCriterios.includes(criterio.id)) {
                        const rubricHTML = createRubricHTML(criterio);
                        rubricsContainerEl.innerHTML += rubricHTML;
                    }
                });
            }
        }

        /**
         * Crea el string HTML para una tarjeta de rúbrica completa.
         */
        function createRubricHTML(criterio) {
            let headHTML = '<tr class="divide-x divide-gray-200">';
            criterio.niveles.forEach(nivel => {
                headHTML += `<th class="rubric-cell py-2 px-2 md:py-4 md:px-4 text-xs md:text-sm font-medium text-gray-800 align-top ${nivel.color} w-1/5">${nivel.nivel}</th>`;
            });
            headHTML += '</tr>';

            let bodyHTML = '<tr class="divide-x divide-gray-200">';
            criterio.niveles.forEach(nivel => {
                bodyHTML += `<td class="rubric-cell py-2 px-2 md:py-4 md:px-4 text-xs md:text-sm text-gray-600 align-top ${nivel.color} w-1/5">${nivel.descriptor}</td>`;
            });
            bodyHTML += '</tr>';
            
            const fullHTML = `
                <div class="bg-white p-4 md:p-5 lg:p-8 rounded-xl shadow-lg transition-all duration-300">
                    <h2 class="text-xl md:text-2xl lg:text-3xl font-bold text-blue-700 mb-3">${criterio.titulo}</h2>
                    <p class="text-sm md:text-base text-gray-600 mb-6 pb-4 md:mb-8 md:pb-6 border-b border-gray-200">${criterio.descripcion}</p>
                    <div class="overflow-x-auto">
                        <table class="rubric-table min-w-full border border-gray-200 divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                ${headHTML}
                            </thead>
                            <tbody class="bg-white">
                                ${bodyHTML}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
            
            return fullHTML;
        }

        // ===== INICIO: BLOQUE DE CÓDIGO MODIFICADO/AÑADIDO =====
        // Se eliminan las funciones exportToClassroomCSV y exportToClassroomCSVCompetencias
        // y se reemplazan por estas tres funciones nuevas:

        // --- FUNCIONES DE EXPORTACIÓN ---

        /**
         * Limpia un string HTML y lo formatea para CSV, encerrándolo entre comillas.
         */
        function cleanDescriptor(htmlString) {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = htmlString;
            const textoPlano = tempDiv.textContent || tempDiv.innerText || '';
            // Limpiar saltos de línea y espacios múltiples, y escapar comillas
            const textoLimpio = textoPlano.replace(/\s+/g, ' ').trim();
            return `"${textoLimpio.replace(/"/g, '""')}"`;
        }
        
        /**
         * Genera las líneas de puntos y descriptores según el formato seleccionado.
         */
        function getExportData(format, nivelesInvertidos) {
            let puntosLinea = "\t";
            let descriptoresLinea = "\t";
        
            // Extraer descriptores limpios (Alto a Bajo)
            const desc_10 = cleanDescriptor(nivelesInvertidos[0].descriptor); // (9-10)
            const desc_8_9 = cleanDescriptor(nivelesInvertidos[1].descriptor); // (7-8.9)
            const desc_5_6 = cleanDescriptor(nivelesInvertidos[2].descriptor); // (5-6.9)
            const desc_3_4 = cleanDescriptor(nivelesInvertidos[3].descriptor); // (3-4.9)
            const desc_1_2 = cleanDescriptor(nivelesInvertidos[4].descriptor); // (1-2.9)
            const desc_0 = `"No entregado"`;
        
            switch(String(format)) {
                case '1': // 1) 10, 8, 6, 4, 2 (5 niveles)
                    puntosLinea += "10.0\t8.0\t6.0\t4.0\t2.0";
                    descriptoresLinea += `${desc_10}\t${desc_8_9}\t${desc_5_6}\t${desc_3_4}\t${desc_1_2}`;
                    break;
                case '2': // 2) 10, 8, 6, 4, 2, 0 (6 niveles)
                    puntosLinea += "10.0\t8.0\t6.0\t4.0\t2.0\t0.0";
                    descriptoresLinea += `${desc_10}\t${desc_8_9}\t${desc_5_6}\t${desc_3_4}\t${desc_1_2}\t${desc_0}`;
                    break;
                case '3': // 3) 10, 8.5, 7.5, 6.5, 5.5, 4.5, 3.5, 2.5, 1.5 (9 niveles)
                    puntosLinea += "10.0\t8.5\t7.5\t6.5\t5.5\t4.5\t3.5\t2.5\t1.5";
                    descriptoresLinea += `${desc_10}\t${desc_8_9}\t${desc_8_9}\t${desc_5_6}\t${desc_5_6}\t${desc_3_4}\t${desc_3_4}\t${desc_1_2}\t${desc_1_2}`;
                    break;
                case '4': // 4) 10, 8.5, 7.5 ... 1.5, 0 (10 niveles)
                    puntosLinea += "10.0\t8.5\t7.5\t6.5\t5.5\t4.5\t3.5\t2.5\t1.5\t0.0";
                    descriptoresLinea += `${desc_10}\t${desc_8_9}\t${desc_8_9}\t${desc_5_6}\t${desc_5_6}\t${desc_3_4}\t${desc_3_4}\t${desc_1_2}\t${desc_1_2}\t${desc_0}`;
                    break;
                default: // Fallback a la opción 1
                    puntosLinea += "10.0\t8.0\t6.0\t4.0\t2.0";
                    descriptoresLinea += `${desc_10}\t${desc_8_9}\t${desc_5_6}\t${desc_3_4}\t${desc_1_2}`;
            }
            
            return { puntosLinea, descriptoresLinea };
        }

        /**
         * Función genérica para generar y descargar un archivo CSV con el formato de Google Classroom.
         * @param {Array} criteriaList - La lista de objetos de criterio a exportar.
         * @param {string} format - El ID del formato ('1', '2', '3', o '4').
         */
        function generateAndDownloadCSV(criteriaList, format) {
            // Cabeceras fijas
            let csvRows = [
                "Se recomienda no editar las guías de evaluación en formato de hoja de cálculo",
                "v1.0-s"
            ];
        
            if (!criteriaList || criteriaList.length === 0) {
                alert("No hay criterios seleccionados para exportar.");
                return;
            }
        
            // Procesar cada criterio
            criteriaList.forEach(criterio => {
                // Título abreviado
                const tituloAbreviado = getTituloAbreviado(criterio.titulo);
                csvRows.push(tituloAbreviado);
                
                // Descripción completa
                csvRows.push(criterio.descripcion);
                
                // Invertir niveles (de más alto a más bajo)
                const nivelesInvertidos = [...criterio.niveles].reverse();
                
                // Obtener líneas de puntos y descriptores según el formato
                const { puntosLinea, descriptoresLinea } = getExportData(format, nivelesInvertidos);
                
                csvRows.push(puntosLinea);
                csvRows.push(descriptoresLinea);
                
                // Línea vacía
                csvRows.push("");
            });
        
            // Crear y descargar el archivo
            const csvString = csvRows.join('\n');
            const BOM = '\uFEFF'; // Byte Order Mark para UTF-8
            const blob = new Blob([BOM + csvString], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.setAttribute('href', url);
            link.setAttribute('download', 'rubricas_tecnologia_classroom.csv');
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        
            // Mostrar confirmación con los pasos correctos
            setTimeout(() => {
                alert(`Se han exportado ${criteriaList.length} criterio(s) correctamente.\n\nSiguientes pasos:\n\n1) Exporta el .csv desde la aplicación\n2) Abre una Google Sheet en blanco\n3) Importa el archivo .csv a la Google Sheet\n4) Renombra la Google Sheet, por ejemplo, a "Rúbrica para importar"\n5) Importa la rúbrica desde Classroom`);
            }, 500);
        }

        // ===== FIN: BLOQUE DE CÓDIGO MODIFICADO/AÑADIDO =====


        /**
         * Convierte el título completo en un formato abreviado para la exportación.
         * Ejemplo: "TEC.4.3.1. Intercambiar información" -> "TEC 4.3.1. (intercambio información)"
         */
				function getTituloAbreviado(tituloCompleto) {
			// Extraer el código (TEC.4.3.1.)
			const codigoMatch = tituloCompleto.match(/^(TEC\.\d+\.\d+\.\d+)\./);
			if (!codigoMatch) return tituloCompleto;
			
			const codigo = codigoMatch[1] + '.'; // TEC.4.5.1. (mantiene los puntos)
			
			// Extraer la parte descriptiva y crear un título abreviado
			let descripcionAbreviada = tituloCompleto.replace(/^TEC\.\d+\.\d+\.\d+\.\s*/, '');
			
			// Crear abreviaciones comunes
			const abreviaciones = {
				'Intercambiar información': 'Intercambiar información',
				'Presentar y difundir': 'Presentar y difundir',
				'Idear y planificar': 'Idear y planificar',
				'Estrategias colaborativas': 'Estrategias colaborativas',
				'Gestión creativa de proyectos': 'Gestión de proyectos',
				'Analizar diseño y ciclo de vida': 'Analizar diseño y ciclo de vida',
				'Fabricar productos': 'Fabricación de productos',
				'Diseñar sistemas automáticos': 'Diseñar sistemas automáticos',
				'Integrar tecnologías emergentes': 'Integrar tecnologías emergentes',
				'Resolver tareas': 'Resolución de tareas',
				'Uso responsable': 'Uso responsable de la tecnología',
				'Analizar arquitectura bioclimática': 'Arquitectura bioclimática y ecotransporte',
				'Valorar proyectos sociales': 'Proyectos tecnológicos de carácter social'
			};
			
			// Aplicar abreviación si existe
			for (const [completo, abreviado] of Object.entries(abreviaciones)) {
				if (descripcionAbreviada.includes(completo)) {
					descripcionAbreviada = abreviado;
					break;
				}
			}
			
			return `${codigo} ${descripcionAbreviada}`; // Sin paréntesis
		}


    </script>
    <script src="./regist_serviceWorker.js"></script>
	
</body>
</html>